# Circuit Segmentation and Modeling

This project aims to interpret and model electrical schematics using computer vision algorithms.

## Table of Contents

- [Circuit Segmentation and Modeling](#circuit-segmentation-and-modeling)
    - [Project structure](#project-structure)
    - [Compilation](#compilation)
    - [Tests](#tests)
    - [Code coverage](#code-coverage)
    - [Documentation](#documentation)
    - [Code formatting and analysis](#code-formatting-and-analysis)

## Project structure

This project has the following structure:

- `cmake/`: contains useful CMake files
- `docs/`: contains documentation related to the software architecture and the segmentation map generated by this software, as well as results for some circuit examples
- `doxygen/`: contains the doxyfile used to build doxygen documentation
- `scripts/`: contains useful scripts
- `src/`: contains the source code of the project
- `tests/`: contains files related with tests
- `.clang-format`: file with the code formatting rules
- `.clang-tidy`: file with the code analysis checks
- `.gitignore`: file that specifies intentionally untracked files that Git should ignore
- `CMakeLists.txt`: root CMake file
- `LICENSE`: license file
- `README.md`: README file of this project

## Dependencies

The following libraries are used in this project:

- [**OpenCV**](https://github.com/opencv/opencv): Open Source Computer Vision Library
    - It needs to be installed on the system
    - Version used during the development of this project: 4.5.5
- [**GoogleTest**](https://github.com/google/googletest): Google Testing and Mocking Framework
    - It is fetched with CMake (if `BUILD_TESTS` option is ON)
    - Version used during the development of this project: 1.11.0
- [**stduuid**](https://github.com/mariusbancila/stduuid): a C++17 cross-platform implementation for universally unique identifiers (UUIDs)
    - It is fetched with CMake
    - Version used during the development of this project: commit hash `3afe7193facd5d674de709fccc44d5055e144d7a`
- [**json**](https://github.com/nlohmann/json): JSON for Modern C++
    - It is fetched with CMake
    - Version used during the development of this project: 3.11.2

## Compilation

This project uses the [CMake](https://cmake.org/) tool for build configuration. The CMake options for this project are:

| CMake Option | Description | Default value |
| --- | --- | --- |
| CMAKE_BUILD_TYPE | Build type on single-configuration generators. <br /> Typical values include Debug, Release, RelWithDebInfo and MinSizeRel. | Debug |
| BUILD_TESTS | Build unit tests | OFF |
| BUILD_COVERAGE | Build with code coverage | OFF |

The following commands can be used to compile this project (example for Debug configuration):
```sh
$ cd <project-directory>
$ mkdir build-debug
$ cd build-debug
$ cmake .. -DCMAKE_BUILD_TYPE=Debug
$ cmake --build .
```

## Tests

To run the unit tests, use the commands below:
```sh
$ cd <project-directory>
$ mkdir build-debug
$ cd build-debug
$ cmake .. -DCMAKE_BUILD_TYPE=Debug -DBUILD_TESTS=ON
$ cmake --build .
$ ctest
```

## Code coverage

This project uses the [Gcovr](https://github.com/gcovr/gcovr) tool to obtain the code coverage. Gcovr is available as a Python package that can be installed via pip:
```sh
$ pip install gcovr
```

For Windows, as Gcovr uses the GNU `gcov` utility, the [MinGW-w64](https://www.mingw-w64.org/) needs to be installed on the system.

The project can be compiled for code coverage analysis, using the following commands:
```sh
$ cd <project-directory>
$ mkdir build-coverage
$ cd build-coverage
$ cmake .. -DCMAKE_BUILD_TYPE=Debug -DBUILD_TESTS=ON -DBUILD_COVERAGE=ON -G "MinGW Makefiles"
$ cmake --build .
```

For generation of the report, use the correspondent script as follows:
```sh
$ cd <project-directory>
$ ./scripts/coverage-gcovr-gen.sh build-coverage
```

The report file named `coverage.html` is created in the `build-coverage/coverage` directory.

## Documentation

This project uses the [doxygen](https://doxygen.nl/) tool for documentation generation. The correspondent script can be used to generate the documentation:
```sh
$ cd <project-directory>
$ ./scripts/doxygen-doc-gen.sh ./doxygen/Doxyfile
```

The documentation is created and can be accessed in `build-doxygen/html/index.html`.

## Code formatting and analysis

This projects uses [clang-format](https://clang.llvm.org/docs/ClangFormat.html) tool for code formatting. The format of the code can be checked using the correspondent script:
```sh
$ cd <project-directory>
$ # To check the src directory
$ ./scripts/clang-format-check.sh ./src
```

For code static analysis, this project uses [clang-tidy](https://clang.llvm.org/extra/clang-tidy/) tool. The correspondent script can be used to analyze the code (MinGW-w64 needs to be installed on the system to use this script):
```sh
$ cd <project-directory>
$ ./scripts/clang-tidy-check.sh
```

A report file is created in the `build-clang-tidy` directory.
